<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Representación de Filtros</title><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><style>:root{--b:#f0f0f0;--p:#ffffff;--d:#dcdcdc;--a:#007acc;--x:#ffcccc;--i:#cceeff}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;margin:0;padding:0;background-color:#fcfcfc;height:100vh;display:flex;flex-direction:column;overflow:hidden}#S{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#ffffff80;z-index:9999;display:flex;justify-content:center;align-items:center;backdrop-filter:blur(2px)}.q{width:500px;height:300px;background-color:#F0F0F0;border:1px solid #B0B0B0;border-radius:15px;display:flex;flex-direction:column;padding:20px;box-shadow:0 10px 25px #00000033}.t{font-size:20px;font-weight:700;text-align:center;margin-bottom:5px;color:#333}.u{font-size:8px;text-align:center;color:#555;font-family:Arial}.f{margin-top:auto;display:flex;flex-direction:column;gap:10px}#P{border:1px solid #B0B0B0;border-radius:5px;background:#fff;height:20px;overflow:hidden;position:relative}#B{height:100%;width:0%;background-color:#007ACC;border-radius:2px;transition:width .1s linear}#I{background-color:#4CAF50;color:#fff;border:none;padding:10px;border-radius:5px;font-weight:700;cursor:pointer;display:none}#I:hover{background-color:#45a049}#M{display:flex;flex-direction:row;height:100%;display:none}#C{width:350px;background-color:var(--p);border-right:1px solid var(--d);padding:15px;overflow-y:auto;display:flex;flex-direction:column;gap:15px}.g{border:1px solid var(--d);border-radius:4px;padding:10px;position:relative;margin-top:10px}.k{position:absolute;top:-10px;left:10px;background:var(--p);padding:0 5px;font-size:12px;color:#333}.r{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;font-size:13px}.r label{flex:1}.r select,.r input{flex:1.2;padding:2px}#G{flex:1;padding:20px;background-color:#fff;position:relative}canvas{width:100%!important;height:100%!important}button{cursor:pointer;padding:5px 10px;border-radius:3px;border:1px solid #999}#fr{background-color:#cceeff;border-color:#88ccee;width:100%;margin-bottom:5px}#cl{background-color:#ffcccc;border-color:#ff9999;width:100%;margin-bottom:15px}#pl{width:100%;padding:8px;display:flex;align-items:center;justify-content:center;gap:5px;margin-bottom:5px}.act button{margin-bottom:5px;width:100%}input[type=range]{width:100%}.h{display:none}</style></head><body><div id="S"><div class="q"><div style="flex:1;display:flex;flex-direction:column;justify-content:center"><div class="t">Representación de Filtros</div><div class="u">_REPLICANT_OR_HUMAN_?</div></div><div class="f"><div id="P"><div id="B"></div></div><button id="I">Ingresar</button></div></div></div><div id="M"><div id="C"><div class="g"><div class="k">Seleccionar un Filtro</div><select id="sF" style="width:100%"><option value="HPLP">Pasa-Alto / Pasa-Bajo</option><option value="BP">Pasa-Banda</option><option value="BR">Rechaza-Banda</option></select></div><div class="g h" id="bp"><div class="k">Parámetros Pasa-Banda</div><div class="r"><label>Frec. Central:</label><input type="number" id="bF" value="1000" min="20" max="20000"> Hz</div><div class="r"><label>Ancho de Banda:</label><input type="number" id="bW" value="1.0" step="0.1" min="0.1"> Oct</div><div class="r"><label>Pendiente:</label><select id="bO"></select></div></div><div class="g h" id="br"><div class="k">Parámetros Rechaza-Banda</div><div class="r"><label>Frec. Central:</label><input type="number" id="rF" value="1000" min="20" max="20000"> Hz</div><div class="r"><label>Ancho de Banda:</label><input type="number" id="rW" value="0.5" step="0.1" min="0.1"> Oct</div><div class="r"><label>Pendiente:</label><select id="rO"></select></div></div><div class="g" id="hl"><div class="k">Parámetros Pasa-Alto / Pasa-Bajo</div><div class="r"><label>Tipo:</label><select id="hT"><option value="lowpass">Pasa-Bajos</option><option value="highpass">Pasa-Altos</option></select></div><div class="r"><label>Frec. de Corte:</label><input type="number" id="hF" value="1000" min="20" max="20000"> Hz</div><div class="r"><label>Pendiente:</label><select id="hO"></select></div></div><div class="g"><div class="k">Estilo de la Curva a Congelar</div><div class="r"><label>Color:</label><select id="cC"></select></div><div class="r"><label>Estilo de Línea:</label><select id="cS"></select></div></div><div class="g"><div class="k">Controles de Audio</div><button id="pl">▶ Reproducir Señal de Control (Ruido)</button><div class="r" style="margin-top:5px"><label style="flex:0.3">Nivel:</label><input type="range" id="vS" min="0" max="100" value="20"></div><div style="margin-top:5px"><input type="checkbox" id="cP" checked> <label>Procesar</label></div></div><div style="flex-grow:1"></div><div class="g act"><div class="k">Acciones</div><button id="fr">Congelar Curva Actual</button><button id="cl">Limpiar Gráfico</button><div style="height:15px"></div><button id="ex">Exportar Gráfico</button><button id="qt">Salir</button></div></div><div id="G"><canvas id="x"></canvas></div></div><script>
(()=>{const _s=44100,_C={'Azul':'#007acc','Verde':'#5cb85c','Rojo':'#d9534f','Cian':'cyan','Magenta':'magenta','Naranja':'darkorange','Negro':'black'},_S={'Continua':[],'Punteada':[5,5],'Guion-Punto':[10,5,2,5],'Puntos':[2,5]};let _fD=[],_A=null,_P=!1,_N=null,_g=null,_FC=[],_cH=null;const gID=i=>document.getElementById(i),_={M:gID('M'),S:gID('S'),B:gID('B'),I:gID('I'),FS:gID('sF'),pB:gID('bp'),pR:gID('br'),pH:gID('hl'),bF:gID('bF'),bW:gID('bW'),bO:gID('bO'),rF:gID('rF'),rW:gID('rW'),rO:gID('rO'),hT:gID('hT'),hF:gID('hF'),hO:gID('hO'),cC:gID('cC'),cS:gID('cS'),bP:gID('pl'),vS:gID('vS'),cP:gID('cP'),bZ:gID('fr'),bC:gID('cl'),bE:gID('ex'),bQ:gID('qt')};function iS(){let p=0;const t=setInterval(()=>{p+=2.5;p>=100&&(p=100,clearInterval(t),_.B.style.display='none',gID('P').style.display='none',_.I.style.display='block');_.B.style.width=p+'%'},40);_.I.addEventListener('click',()=>{_.S.style.display='none';_.M.style.display='flex';iA()})}function pS(){const s=[1,2,3,4].map(i=>`<option value="${i}">${i*6} dB/oct (Orden ${i})</option>`).join('');_.bO.innerHTML=_.rO.innerHTML=_.hO.innerHTML=s;_.hO.value="2";Object.keys(_C).forEach(k=>{const o=document.createElement('option');o.text=k;o.value=_C[k];_.cC.add(o)});Object.keys(_S).forEach(k=>{const o=document.createElement('option');o.text=k;o.value=k;_.cS.add(o)})}function sC(){const ctx=gID('x').getContext('2d'),l=[];let v=20;while(v<=2e4){l.push(v);v<100?v+=10:v<1e3?v+=100:v<1e4?v+=1e3:v+=5e3}_cH=new Chart(ctx,{type:'line',data:{datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,animation:!1,scales:{x:{type:'logarithmic',min:20,max:2e4,title:{display:!0,text:'Frecuencia (Hz)',font:{size:14}},grid:{color:'#e0e0e0'}},y:{min:-60,max:6,title:{display:!0,text:'Ganancia (dB)',font:{size:14}},grid:{color:'#e0e0e0'}}},plugins:{legend:{display:!0},title:{display:!0,text:'Respuesta en Frecuencia',font:{size:16}}},elements:{point:{radius:0}}}});uP()}function iA(){pS();_.FS.addEventListener('change',oFC);const l=[_.bF,_.bW,_.bO,_.rF,_.rW,_.rO,_.hT,_.hF,_.hO];l.forEach(e=>e.addEventListener(e.tagName==='SELECT'?'change':'input',()=>{uP();_P&&uAP()}));_.bZ.addEventListener('click',fC);_.bC.addEventListener('click',cF);_.bE.addEventListener('click',eF);_.bQ.addEventListener('click',()=>window.close());_.bP.addEventListener('click',tA);_.vS.addEventListener('input',()=>{if(_g)_g.gain.value=_.vS.value/100});_.cP.addEventListener('change',uAP);oFC();sC()}function oFC(){const t=_.FS.value;_.pH.classList.toggle('h',t!=='HPLP');_.pB.classList.toggle('h',t!=='BP');_.pR.classList.toggle('h',t!=='BR');uP();_P&&uAP()}function cM(qs){const m=_.FS.value,md=[];if(m==='HPLP'){const c=parseFloat(_.hF.value),o=parseInt(_.hO.value),il=_.hT.value==='lowpass';if(c<=0||c>=_s/2)return null;for(let f of qs){let r=f/c;il||(r=c/f);const g=1/(1+Math.pow(r,2*o));md.push({x:f,y:10*Math.log10(Math.max(1e-10,g))})}return{d:md,l:`${il?'FPB':'FPA'} O${o}: ${c}Hz`}}const ip=m==='BP',fc=parseFloat(ip?_.bF.value:_.rF.value),bo=parseFloat(ip?_.bW.value:_.rW.value),ord=parseInt(ip?_.bO.value:_.rO.value),fl=fc*Math.pow(2,-bo/2),fu=fc*Math.pow(2,bo/2),bw=fu-fl;if(fl<=0||fu>=_s/2)return null;for(let f of qs){if(f===0){md.push({x:f,y:-100});continue}let n=f*f-fc*fc,d=f*bw,wp=n/d,gs=0;ip?gs=1/(1+Math.pow(wp,2*ord)):gs=1/(1+Math.pow(1/wp,2*ord));md.push({x:f,y:10*Math.log10(Math.max(1e-10,gs))})}return{d:md,l:`${ip?'BPF':'BRF'} O${ord}: ${fc}Hz, ${bo}oct`}}function gF(){let a=[],min=Math.log10(20),max=Math.log10(2e4);for(let i=0;i<512;i++)a.push(Math.pow(10,min+(i/512)*(max-min)));return a}function uP(){if(!_cH)return;const fr=gF(),res=cM(fr);_cH.data.datasets=[];_fD.forEach(i=>{_cH.data.datasets.push({label:i.l,data:i.d,borderColor:i.c,borderWidth:2,borderDash:_S[i.s],fill:!1,pointRadius:0})});if(res){_cH.data.datasets.push({label:res.l+" (Activa)",data:res.d,borderColor:'gray',borderWidth:2.5,borderDash:[5,5],fill:!1,pointRadius:0})}_cH.update()}function fC(){const r=cM(gF());if(!r)return;_fD.push({d:r.d,l:r.l,c:_C[_.cC.options[_.cC.selectedIndex].text],s:_.cS.value});uP()}function cF(){_fD=[];uP()}function eF(){const l=document.createElement('a');l.download='filtro.png';l.href=gID('x').toDataURL('image/png',1);l.click();alert("Gráfico exportado.")}function gAC(){return _A||(_A=new(window.AudioContext||window.webkitAudioContext)({sampleRate:_s})),_A}function cNB(){const x=gAC(),s=x.sampleRate*2,b=x.createBuffer(1,s,x.sampleRate),d=b.getChannelData(0);for(let i=0;i<s;i++)d[i]=Math.random()*2-1;return b}function cCh(x){_FC=[];const m=_.FS.value,no=[];let nS=1,tp='lowpass',fr=1000,Q=.707;if(m==='HPLP'){fr=parseFloat(_.hF.value);tp=_.hT.value;const o=parseInt(_.hO.value);nS=Math.ceil(o/2)}else{const ip=m==='BP';tp=ip?'bandpass':'notch';fr=parseFloat(ip?_.bF.value:_.rF.value);const bo=parseFloat(ip?_.bW.value:_.rW.value),o=parseInt(ip?_.bO.value:_.rO.value),fl=fr*Math.pow(2,-bo/2),fu=fr*Math.pow(2,bo/2),bw=fu-fl;Q=fr/bw;nS=Math.ceil(o/2)}for(let i=0;i<nS;i++){const n=x.createBiquadFilter();n.type=tp;n.frequency.value=fr;n.Q.value=Q;no.push(n)}return no}function uAP(){if(!_N)return;if(!_.cP.checked){if(_FC.length>0){try{_N.disconnect()}catch(e){}_FC[_FC.length-1].disconnect();_N.connect(_g)}return}try{_N.disconnect()}catch(e){}_FC.forEach(n=>{try{n.disconnect()}catch(e){}});const x=gAC(),nc=cCh(x);_FC=nc;let c=_N;for(let n of _FC){c.connect(n);c=n}c.connect(_g)}function tA(){const x=gAC();if(_P){if(_N){try{_N.stop()}catch(e){}_N=null}_P=!1;_.bP.innerHTML='▶ Reproducir Señal de Control (Ruido)'}else{x.state==='suspended'&&x.resume();_N=x.createBufferSource();_N.buffer=cNB();_N.loop=!0;_g=x.createGain();_g.gain.value=_.vS.value/100;_g.connect(x.destination);uAP();_N.start();_P=!0;_.bP.innerHTML='⬛ Detener'}}window.onload=iS;})();
</script></body></html>